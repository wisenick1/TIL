카카오 로그인 절차
==

사용자는 앱 사용자, 클라이언트는 프론트를 지칭
 1. 사용자가 카카오 로그인 클릭 
 2. 클라이언트가 카카오 로그인 페이지를 사용자에게 띄워줌 
 3. 계정 아이디 비밀번호 입력 
 4. 카카오 OAuth2에서 인가 코드를 발급해서 클라이언트에게 줌 
 5. 클라이언트가 인가 코드를 백엔드로 전달 
 6. 백엔드에서 카카오 OAuth2로 토큰 요청 
 7. 카카오에서 백엔드로 Access Token + Refresh Token을 줌 
 8. 백엔드에서 Access Token을 카카오로 보내 사용자 정보 요청 
 9. 카카오에서 백엔드로 사용자 정보를 보내줌 
 10. 백엔드에서 정보를 바탕으로 DB 조회해서 회원가입 or 로그인 
 11. 백엔드에서 JWT발급해서 클라이언트에게 넘겨줌 
 12. 그리고 앞으로 이 JWT토큰을 헤더에 넣고 클라이언트에서 백엔드로 요청이 들어옴

 이 절차를 따라 카카오 로그인이 된다.

 프론트를 통해 인가 코드를 받지 않고 백엔드로 직접 받는 법도 있다.

 인가 코드(Authorization Code)
 --

역할: “사용자가 카카오 로그인에 성공했어요”를 짧은 임시 코드로 백엔드에 알려주는 용도.

특징
 
수명이 매우 짧음 (보통 수십 초~1분).

직접 사용자 정보에 접근할 수 없음.

단순히 “로그인 성공”을 증명하는 토큰.

👉 즉, 인가 코드는 Access Token을 교환하기 위한 티켓

Access Token
--

역할: 실제로 카카오 API를 호출할 수 있는 권한 증명서.

특징

유효기간이 짧음 (예: 6시간).

이 토큰을 카카오에 보내야 “사용자 정보 주세요” 같은 요청 가능.

노출되면 위험함 → 다른 사람이 이걸 가지면 내 정보에 접근 가능.

👉 Access Token = 카카오 리소스 서버(API)에 접근할 수 있는 “열쇠”

Refresh Token
--

역할: Access Token이 만료되었을 때 새로운 Access Token을 발급받기 위한 토큰.

특징

유효기간이 김 (예: 2개월).

클라이언트는 보통 직접 쓰지 않고, 백엔드에서만 안전하게 보관.

Access Token이 짧게 만료되더라도, 다시 로그인 안 하고 Refresh Token으로 새 Access Token 발급 가능.

👉 Refresh Token = 열쇠를 새로 발급받을 수 있는 “리필권”

토큰 요약
--
인가코드: 일회용 로그인 확인증

Access Token: 실제 API 열쇠

Refresh Token: 열쇠 재발급권

JWT
--
JWT의 필요성

1. Access Token은 카카오 API 서버를 대상으로만 유효

- 즉, "내 서비스 백엔드"에서는 이 토큰이 직접적으로 의미가 없음.

- 백엔드가 이 토큰을 계속 검증하려면 카카오 서버에 매번 물어봐야 함 (비효율적, 속도 저하).

2. 내 서비스만의 인증 체계 구축

- 카카오 Access Token은 카카오한테만 의미가 있음.

- JWT는 내 서비스가 발급하는 거라, 내 API 호출할 때 “내가 인증한 유저”임을 확인 가능.

3. 독립성 확보

- 서비스의 모든 요청을 카카오에 의존하지 않음.

- 로그인은 카카오로 하되, 그 이후 내 서버 자원(API 접근)은 JWT로 처리.

- 만약 카카오 인증 서버가 장애 나도, 내 서비스 안에서 JWT는 계속 쓸 수 있음.

4. 간편한 인증/인가 처리

- JWT는 Stateless (서버가 세션 저장 필요 없음).

- JWT 안에 userId, roles, exp(만료 시간) 같은 정보를 담아두면, 요청마다 토큰 검증만 하면 됨.

- DB를 매번 조회하거나 카카오에 물어볼 필요 없음 → 빠름.
