데이터 접근 기술 - 테스트
==
> 출처 : 김영한의 [스프링 DB 2편 - 데이터 접근 활용 기술](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-db-2/dashboard)

테스트 코드에서 @SpringBootTest일 때 데이터베이스를 연동하는 방법

사용하는 DB에는 값이 들어있므로 테스트에 활용하기 적합하지 않다. 따라서 test 용 DB를 따로 만들거나 로컬 DB를 사용하는 것을 생각해 볼 수 있다.

test용 DB(DB2개)
--
- DB서버를 새로 만들어서 새로운 DB를 활용하기
- 그러나 여기서는 spring 컨테이너로 등록되는 repository가 MemoryRepository에 해당하지 않으므로 afterEach가 작동하지 않는다.
- 이런 경우는 트랜잭션을 활용할 수 있다.
- 데이터를 커밋하지 않고 테스트가 끝나면 롤백해버리는 것이다.
- tractionManger를 통해 트랜잭션을 시작, 롤백해주면 된다.
- tractionManager의 트랜잭션 시작, 롤백을 @Transactional로 바꿀수 있다.
- 테스트 내의 @Transactional은 동작이 조금 다르다. 테스트 성공 시 트랜잭션을 강제로 롤백!

임베디드 모드 DB(메모리 DB)
--
- 데이터 소스를 통해 메모리 DB를 사용할 수 있다.(동일하게 @Transactional은 활용)
- 그러나 데이터 소스를 활용하지 않아도 springboot 내에서 메모리 DB가 자동적으로 생성된다.

정리
--
테스트코드에서 @Transactional 써라!


