ELB로 HTTPS 적용시키기
==

ELB
--
트래픽을 분배시켜주는 장치
- 로드밸런서
- 부가기능으로 SSL/TLS(HTTPS) 적용시키기가 있다.

SSL/TLS
--
HTTP -> HTTPS로 바꿔주는 인증서

왜 HTTS를 써야할까
--
1. 보안
2. 사용자 이탈 방지(이상하게 뜨면 들어가기가 꺼려진다)

ELB 생성
--
1. EC2 내의 로드밸런서 선택(리전도 맞추기)
2. 로드 밸런서 생성하면 유형 ALB 선택
3. 기본 구성 - 인터넷 경계(Public IP), IPv4
4. 네트워크 매핑 - 가용 영역 모두 열어주기
5. 보안그룹 등록하기
    - 보안그룹을 따로 만든다
    - 인바운드 HTTP, HTTPS를 모두 넣은 보안그룹 만들기
6. 리스너 및 라우팅 / 헬스 체크
    - 대상 그룹(ELB로 들어온 요청을 어디로 보낼지) 생성 : ec2의 유형을 택하면 됨(HTTP, IPv4, HTTP1)
    - 상태 검사 : 상태 검사 경로를 만들어 200번대 응답이 날라오도록 Controller를 만들어주어야한다.
    - 대상 등록
7. 로드 밸런서 생성
8. 6번의 Health Check API를 Controller에 만들어서 내용을 반영시켜 배포해주자.


ELB에 도메인 연결
--
ELB 도메인 주소가 알아서 만들어지는데 이게 무슨 소리인가 했는데, 생성된 도메인 말고 원하는 도메인(예시 www.naver.com)으로 ELB를 연결 시키는 것을 의미한다. 이제껏 해당 도메인을 들어가면 ec2에 직접 연결하게 했었는데 이제 ELB로 연결되게 하는 것이다.

1. EC2에 연결되어 있는 도메인 삭제(Route 53)
2. 레코드 생성으로 별칭을 활용하여 로드 밸런서를 연결시켜주자

HTTPS 적용전 인증서 발급
--
1. AWS Certificate Manager에서 인증서 요청
2. 도메인 이름을 적고 요청
3. 인증서 검증(도메인 주인 맞니? -> 검증 대기 중이라고 뜨는데 이를 Route 53에서 검증 -> Route 53 내에 생성된다)

ELB에 HTTPS 설정
--
1. ELB 리스너에 HTTPS 추가하기(대상그룹, 보안 리스너 설정)
2. 문제는 지금은 HTTP도 위에서 만들어놨기 때문에 HTTP도 접속이 되는 상황이다. 따라서 이를 HTTPS로 가도록 해줘야한다.
3. 기존 HTTP ELB 삭제 - 여기서 삭제할 때 정보가 다 날아가는거 아닌가 했는데, 기본 정보는 로드 밸런서 자체에 적용되어있고, 리스너 추가 할때 대상 그룹 지정할 때, 헬스 체크 같은게 안에 다 들어있다~~
4. 새로운 리스너 추가 URL로 리디렉션해서 HTTPS 지정

> 출처 : JSCODE 박재성의 [비전공자도 이해할 수 있는 AWS 입문/실전](https://www.inflearn.com/course/비전공자-이해할수있는-aws-입문실전/dashboard)
